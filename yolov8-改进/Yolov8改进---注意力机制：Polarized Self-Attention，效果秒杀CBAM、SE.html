<div id="article_content" class="article_content clearfix">
        <link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/kdoc_html_views-1a98987dfd.css">
        <link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/ck_htmledit_views-dc4a025e85.css">
                <div id="content_views" class="htmledit_views">
                    <h3 id="3.%C2%A0Polarized%20Self-Attention"><a name="t0"></a>&nbsp;1.&nbsp;Polarized <a href="https://so.csdn.net/so/search?q=Self-Attention&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=Self-Attention&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;Self-Attention\&quot;}&quot;}" data-tit="Self-Attention" data-pretit="self-attention">Self-Attention</a></h3> 
<p class="img-center"><img alt="" height="135" src="https://img-blog.csdnimg.cn/6543fca9a7a54e6c8d3de98f86a51db3.png" width="596"></p> 
<p></p> 
<p>&nbsp;è®ºæ–‡ï¼š<a href="https://export.arxiv.org/pdf/2107.00782.pdf" title="https://export.arxiv.org/pdf/2107.00782.pdf">https://export.arxiv.org/pdf/2107.00782.pdf</a></p> 
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Polarized self-attentionæ˜¯ä¸€ç§æ”¹è¿›çš„<a href="https://so.csdn.net/so/search?q=%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;è‡ªæ³¨æ„åŠ›æœºåˆ¶\&quot;}&quot;}" data-tit="è‡ªæ³¨æ„åŠ›æœºåˆ¶" data-pretit="è‡ªæ³¨æ„åŠ›æœºåˆ¶">è‡ªæ³¨æ„åŠ›æœºåˆ¶</a>ï¼Œæ—¨åœ¨æé«˜è‡ªæ³¨æ„åŠ›æ¨¡å‹çš„æ•ˆç‡å’Œå‡†ç¡®æ€§ã€‚ä¼ ç»Ÿçš„è‡ªæ³¨æ„åŠ›æœºåˆ¶é€šå¸¸éœ€è¦è®¡ç®—æ‰€æœ‰ä½ç½®å¯¹æ‰€æœ‰ä½ç½®çš„æ³¨æ„åŠ›ï¼Œè¿™ä¼šå¯¼è‡´è®¡ç®—å¤æ‚åº¦çš„å¢åŠ å’Œæ¨¡å‹çš„è®­ç»ƒæ—¶é—´çš„å»¶é•¿ã€‚Polarized self-attentioné€šè¿‡å¼•å…¥æåŒ–å› å­æ¥å‡å°‘éœ€è¦è®¡ç®—çš„ä½ç½®å¯¹ä¹‹é—´çš„æ³¨æ„åŠ›ï¼Œä»è€Œæé«˜è‡ªæ³¨æ„åŠ›æ¨¡å‹çš„æ•ˆç‡ã€‚æåŒ–å› å­æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå¯ä»¥å°†å…¶ä¸æ¯ä¸ªä½ç½®çš„å‘é‡ç‚¹ç§¯ï¼Œä»¥ç¡®å®šå“ªäº›ä½ç½®éœ€è¦è¿›è¡Œæ³¨æ„åŠ›è®¡ç®—ã€‚è¿™ç§æ–¹æ³•å¯ä»¥é€šè¿‡åœ¨ä¿æŒå‡†ç¡®åº¦çš„åŒæ—¶å‡å°‘è®¡ç®—é‡æ¥æé«˜è‡ªæ³¨æ„åŠ›æ¨¡å‹çš„æ•ˆç‡ã€‚&nbsp;</p> 
<p><img alt="" height="559" src="https://img-blog.csdnimg.cn/028c178a847f4c3d9b1d7a8470b498c3.png" width="897"></p> 
<h2 id="%F0%9F%8F%86%F0%9F%8F%86%F0%9F%8F%86%F0%9F%8F%86%F0%9F%8F%86%F0%9F%8F%86Yolov8%E9%AD%94%E6%9C%AF%E5%B8%88%F0%9F%8F%86%F0%9F%8F%86%F0%9F%8F%86%F0%9F%8F%86%F0%9F%8F%86%F0%9F%8F%86" style="text-align:center;"><a name="t1"></a>ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†Yolov8é­”æœ¯å¸ˆğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†</h2> 
<h2><a name="t2"></a><a name="t2"></a></h2> 
<h3 id="%E2%9C%A8%E2%9C%A8%E2%9C%A8%E9%AD%94%E6%94%B9%E7%BD%91%E7%BB%9C%E3%80%81%E5%A4%8D%E7%8E%B0%E5%89%8D%E6%B2%BF%E8%AE%BA%E6%96%87%EF%BC%8C%E7%BB%84%E5%90%88%E4%BC%98%E5%8C%96%E5%88%9B%E6%96%B0"><a name="t3"></a>âœ¨âœ¨âœ¨é­”æ”¹ç½‘ç»œã€å¤ç°å‰æ²¿è®ºæ–‡ï¼Œç»„åˆä¼˜åŒ–åˆ›æ–°</h3> 
<h3 id="%F0%9F%9A%80%F0%9F%9A%80%F0%9F%9A%80%E5%B0%8F%E7%9B%AE%E6%A0%87%E3%80%81%E9%81%AE%E6%8C%A1%E7%89%A9%E3%80%81%E9%9A%BE%E6%A0%B7%E6%9C%AC%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87"><a name="t4"></a>ğŸš€ğŸš€ğŸš€å°ç›®æ ‡ã€é®æŒ¡ç‰©ã€éš¾æ ·æœ¬æ€§èƒ½æå‡</h3> 
<h3 id="%F0%9F%8D%89%F0%9F%8D%89%F0%9F%8D%89%E5%AE%9A%E6%9C%9F%E6%9B%B4%E6%96%B0%E4%B8%8D%E5%90%8C%E6%95%B0%E6%8D%AE%E9%9B%86%E6%B6%A8%E7%82%B9%E6%83%85%E5%86%B5"><a name="t5"></a>ğŸ‰ğŸ‰ğŸ‰å®šæœŸæ›´æ–°ä¸åŒæ•°æ®é›†æ¶¨ç‚¹æƒ…å†µ</h3> 
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;åŸºäºåŒé‡æ³¨æ„åŠ›æœºåˆ¶ï¼Œæœ¬æ–‡é’ˆå¯¹Pixel-wise regressionçš„ä»»åŠ¡ï¼Œæå‡ºäº†ä¸€ç§æ›´åŠ ç²¾ç»†çš„åŒé‡æ³¨æ„åŠ›æœºåˆ¶â€”â€”æåŒ–<a href="https://so.csdn.net/so/search?q=%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;è‡ªæ³¨æ„åŠ›\&quot;}&quot;}" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;è‡ªæ³¨æ„åŠ›\&quot;}&quot;}" data-tit="è‡ªæ³¨æ„åŠ›" data-pretit="è‡ªæ³¨æ„åŠ›">è‡ªæ³¨æ„åŠ›</a>ï¼ˆPolarized Self-Attentionï¼‰ã€‚ä½œä¸ºä¸€ä¸ªå³æ’å³ç”¨çš„æ¨¡å—ï¼Œåœ¨äººä½“å§¿æ€ä¼°è®¡å’Œè¯­ä¹‰åˆ†å‰²ä»»åŠ¡ä¸Šï¼Œä½œè€…å°†å®ƒç”¨åœ¨äº†ä»¥å‰çš„SOTAæ¨¡å‹ä¸Šï¼Œå¹¶è¾¾åˆ°äº†æ–°çš„SOTAæ€§èƒ½ï¼Œéœ¸æ¦œCOCOäººä½“å§¿æ€ä¼°è®¡å’ŒCityscapesè¯­ä¹‰åˆ†å‰²ã€‚</p> 
<p><img alt="" height="634" src="https://img-blog.csdnimg.cn/3222344d46414dd980310e8f99ed61cf.png" width="631"></p> 
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æ³¨æ„åŠ›æœºåˆ¶æ˜¯ä¸€ä¸ªè¢«å¹¿æ³›åº”ç”¨åœ¨å„ç§CVä»»åŠ¡ä¸­çš„æ–¹æ³•ã€‚æ³¨æ„åŠ›æœºåˆ¶æ ¹æ®æ–½åŠ çš„ç»´åº¦å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šé€šé“æ³¨æ„åŠ›å’Œç©ºé—´æ³¨æ„åŠ›ã€‚å¯¹äºé€šé“æ³¨æ„åŠ›æœºåˆ¶ï¼Œä»£è¡¨æ€§çš„å·¥ä½œæœ‰SENetã€ECANetï¼›å¯¹äºç©ºé—´æ³¨æ„åŠ›æœºåˆ¶ï¼Œä»£è¡¨æ€§çš„å·¥ä½œæœ‰Self-Attentionã€‚éšç€ç©ºé—´å’Œé€šé“æ³¨æ„åŠ›æœºåˆ¶çš„æå‡ºï¼Œå¾ˆè‡ªç„¶çš„ï¼Œç»“åˆç©ºé—´å’Œé€šé“ä¸¤ä¸ªç»´åº¦çš„åŒé‡æ³¨æ„åŠ›æœºåˆ¶ä¹Ÿè¢«æå‡ºï¼Œä»£è¡¨å·¥ä½œæœ‰CBAMï¼ŒDANetã€‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p> 
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ä½œè€…æå‡ºäº†ä¸€ä¸ªå³æ’å³ç”¨çš„æ¨¡å—â€”â€”æåŒ–è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆ Polarized Self-Attention(PSA)ï¼‰ï¼Œç”¨äºè§£å†³åƒç´ çº§çš„å›å½’ä»»åŠ¡ï¼Œç›¸æ¯”äºå…¶ä»–æ³¨æ„åŠ›æœºåˆ¶ï¼ŒæåŒ–è‡ªæ³¨æ„åŠ›æœºåˆ¶ä¸»è¦æœ‰ä¸¤ä¸ªè®¾è®¡ä¸Šçš„äº®ç‚¹ï¼š</p> 
<p>1ï¼‰æåŒ–æ»¤æ³¢ï¼ˆ Polarized filteringï¼‰ï¼šåœ¨é€šé“å’Œç©ºé—´ç»´åº¦ä¿æŒæ¯”è¾ƒé«˜çš„resolutionï¼ˆ<strong>åœ¨é€šé“ä¸Šä¿æŒC/2çš„ç»´åº¦ï¼Œåœ¨ç©ºé—´ä¸Šä¿æŒ[H,W]çš„ç»´åº¦</strong>&nbsp;ï¼‰ï¼Œè¿™ä¸€æ­¥èƒ½å¤Ÿå‡å°‘é™ç»´åº¦é€ æˆçš„ä¿¡æ¯æŸå¤±ï¼›</p> 
<p>2ï¼‰å¢å¼ºï¼ˆEnhancementï¼‰ï¼šç»„åˆéçº¿æ€§ç›´æ¥æ‹Ÿåˆå…¸å‹ç»†ç²’åº¦å›å½’çš„è¾“å‡ºåˆ†å¸ƒã€‚</p> 
<p class="img-center"><img alt="" height="632" src="https://img-blog.csdnimg.cn/1ab65b2cde3746a88c6090064cf5b970.png" width="455"></p> 
<p></p> 
<p><img alt="" height="439" src="https://img-blog.csdnimg.cn/f773820b9e774ad3b2f92d1dd7f6c5ad.png" width="1104"></p> 
<h2><a name="t6"></a>&nbsp;2.&nbsp;åŸºäºYolov8çš„Polarized Self-Attentionå®ç°&nbsp;</h2> 
<h2><a name="t7"></a>&nbsp;2.1&nbsp;åŠ å…¥&nbsp;<strong><code>modules.py</code></strong>ä¸­</h2> 
<pre data-index="0" class="set-code-hide" name="code"><code class="hljs language-cobol"><ol class="hljs-ln" style="width:1254px"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">###################### PolarizedSelfAttention  &nbsp;  ####     <span class="hljs-keyword">start</span>   <span class="hljs-keyword">by</span>  AI<span class="hljs-operator">&amp;</span>CV  ###############################</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">from</span> torch import nn</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">from</span> torch.nn import init</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">class</span> PolarizedSelfAttention(nn.Module):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    def __init__(<span class="hljs-keyword">self</span>, channel<span class="hljs-operator">=</span><span class="hljs-number">512</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">super</span>().__init__()</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">self</span>.<span class="hljs-keyword">ch</span>_wv<span class="hljs-operator">=</span>nn.Conv<span class="hljs-number">2</span>d(channel,channel<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,kernel_<span class="hljs-keyword">size</span><span class="hljs-operator">=</span>(<span class="hljs-number">1,1</span>))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">self</span>.<span class="hljs-keyword">ch</span>_wq<span class="hljs-operator">=</span>nn.Conv<span class="hljs-number">2</span>d(channel,<span class="hljs-number">1</span>,kernel_<span class="hljs-keyword">size</span><span class="hljs-operator">=</span>(<span class="hljs-number">1,1</span>))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">self</span>.softmax_channel<span class="hljs-operator">=</span>nn.Softm<span class="hljs-type">ax(1)</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">self</span>.softmax_spatial<span class="hljs-operator">=</span>nn.Softmax(-<span class="hljs-number">1</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">self</span>.<span class="hljs-keyword">ch</span>_wz<span class="hljs-operator">=</span>nn.Conv<span class="hljs-number">2</span>d(channel<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,channel,kernel_<span class="hljs-keyword">size</span><span class="hljs-operator">=</span>(<span class="hljs-number">1,1</span>))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">self</span>.ln<span class="hljs-operator">=</span>nn.LayerNorm(channel)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">self</span>.sigmoid<span class="hljs-operator">=</span>nn.Sigmoid()</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">self</span>.sp_wv<span class="hljs-operator">=</span>nn.Conv<span class="hljs-number">2</span>d(channel,channel<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,kernel_<span class="hljs-keyword">size</span><span class="hljs-operator">=</span>(<span class="hljs-number">1,1</span>))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">self</span>.sp_wq<span class="hljs-operator">=</span>nn.Conv<span class="hljs-number">2</span>d(channel,channel<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,kernel_<span class="hljs-keyword">size</span><span class="hljs-operator">=</span>(<span class="hljs-number">1,1</span>))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">self</span>.agp<span class="hljs-operator">=</span>nn.AdaptiveAvgPool<span class="hljs-number">2</span>d((<span class="hljs-number">1,1</span>))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    def forward(<span class="hljs-keyword">self</span>, x):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        b, c, h, w <span class="hljs-operator">=</span> x.<span class="hljs-keyword">size</span>()</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        #Channel-only Self-Attention</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        channel_wv<span class="hljs-operator">=</span><span class="hljs-keyword">self</span>.<span class="hljs-keyword">ch</span>_wv(x) #bs,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,h,w</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        channel_wq<span class="hljs-operator">=</span><span class="hljs-keyword">self</span>.<span class="hljs-keyword">ch</span>_wq(x) #bs,<span class="hljs-number">1</span>,h,w</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        channel_wv<span class="hljs-operator">=</span>channel_wv.reshape(b,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,-<span class="hljs-number">1</span>) #bs,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,h<span class="hljs-operator">*</span>w</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        channel_wq<span class="hljs-operator">=</span>channel_wq.reshape(b,-<span class="hljs-number">1,1</span>) #bs,h<span class="hljs-operator">*</span>w,<span class="hljs-number">1</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        channel_wq<span class="hljs-operator">=</span><span class="hljs-keyword">self</span>.softmax_channel(channel_wq)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        channel_wz<span class="hljs-operator">=</span>torch.matmul(channel_wv,channel_wq).unsqueeze(-<span class="hljs-number">1</span>) #bs,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2,1,1</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        channel_weight<span class="hljs-operator">=</span><span class="hljs-keyword">self</span>.sigmoid(<span class="hljs-keyword">self</span>.ln(<span class="hljs-keyword">self</span>.<span class="hljs-keyword">ch</span>_wz(channel_wz).reshape(b,c,<span class="hljs-number">1</span>).permute(<span class="hljs-number">0,2,1</span>))).permute(<span class="hljs-number">0,2,1</span>).reshape(b,c,<span class="hljs-number">1,1</span>) #bs,c,<span class="hljs-number">1,1</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        channel_out<span class="hljs-operator">=</span>channel_weight<span class="hljs-operator">*</span>x</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        #Spatial-only Self-Attention</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        spatial_wv<span class="hljs-operator">=</span><span class="hljs-keyword">self</span>.sp_wv(x) #bs,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,h,w</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="35"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        spatial_wq<span class="hljs-operator">=</span><span class="hljs-keyword">self</span>.sp_wq(x) #bs,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,h,w</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="36"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        spatial_wq<span class="hljs-operator">=</span><span class="hljs-keyword">self</span>.agp(spatial_wq) #bs,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2,1,1</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="37"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        spatial_wv<span class="hljs-operator">=</span>spatial_wv.reshape(b,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,-<span class="hljs-number">1</span>) #bs,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>,h<span class="hljs-operator">*</span>w</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="38"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        spatial_wq<span class="hljs-operator">=</span>spatial_wq.permute(<span class="hljs-number">0,2,3,1</span>).reshape(b,<span class="hljs-number">1</span>,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span>) #bs,<span class="hljs-number">1</span>,c<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">2</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="39"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        spatial_wq<span class="hljs-operator">=</span><span class="hljs-keyword">self</span>.softmax_spatial(spatial_wq)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="40"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        spatial_wz<span class="hljs-operator">=</span>torch.matmul(spatial_wq,spatial_wv) #bs,<span class="hljs-number">1</span>,h<span class="hljs-operator">*</span>w</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="41"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        spatial_weight<span class="hljs-operator">=</span><span class="hljs-keyword">self</span>.sigmoid(spatial_wz.reshape(b,<span class="hljs-number">1</span>,h,w)) #bs,<span class="hljs-number">1</span>,h,w</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="42"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        spatial_out<span class="hljs-operator">=</span>spatial_weight<span class="hljs-operator">*</span>x</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="43"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        out<span class="hljs-operator">=</span>spatial_out<span class="hljs-operator">+</span>channel_out</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="44"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">return</span> out</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="45"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="46"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">###################### PolarizedSelfAttention &nbsp;  ####     <span class="hljs-keyword">end</span>   <span class="hljs-keyword">by</span>  AI<span class="hljs-operator">&amp;</span>CV  ###############################</div></div></li></ol></code><div class="hide-preCode-box"><span class="hide-preCode-bt" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}"><img class="look-more-preCode contentImg-no-view" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" title=""></span></div><div class="hljs-button {2}" data-title="å¤åˆ¶" onclick="hljs.copyCode(event)"></div></pre> 
<h3><a name="t8"></a>&nbsp;2.2&nbsp;&nbsp;åŠ å…¥tasks.pyä¸­ï¼š</h3> 
<pre data-index="1"><code class="hljs language-haskell"><span class="hljs-title">from</span> ultralytics.nn.modules <span class="hljs-keyword">import</span> (<span class="hljs-type">C1</span>, <span class="hljs-type">C2</span>, <span class="hljs-type">C3</span>, <span class="hljs-type">C3TR</span>, <span class="hljs-type">SPP</span>, <span class="hljs-type">SPPF</span>, <span class="hljs-type">Bottleneck</span>, <span class="hljs-type">BottleneckCSP</span>, <span class="hljs-type">C2f</span>, <span class="hljs-type">C3Ghost</span>, <span class="hljs-type">C3x</span>, <span class="hljs-type">Classify</span>,<span class="hljs-type">Concat</span>, <span class="hljs-type">Conv</span>, <span class="hljs-type">ConvTranspose</span>, <span class="hljs-type">Detect</span>, <span class="hljs-type">DWConv</span>, <span class="hljs-type">DWConvTranspose2d</span>, <span class="hljs-type">Ensemble</span>, <span class="hljs-type">Focus</span>,<span class="hljs-type">GhostBottleneck</span>, <span class="hljs-type">GhostConv</span>, <span class="hljs-type">Segment</span>,<span class="hljs-type">PolarizedSelfAttention</span>)</code><div class="hljs-button {2}" data-title="å¤åˆ¶" onclick="hljs.copyCode(event)"></div></pre> 
<pre data-index="2"><code class="hljs language-cobol"><ol class="hljs-ln" style="width:100%"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        elif m <span class="hljs-keyword">is</span> PolarizedSelfAttention:</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            c<span class="hljs-number">1</span>, c<span class="hljs-number">2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">ch</span>[f], args[<span class="hljs-number">0</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-keyword">if</span> c<span class="hljs-number">2</span> !<span class="hljs-operator">=</span> nc:</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">                c<span class="hljs-number">2</span> <span class="hljs-operator">=</span> make_divisible(min(c<span class="hljs-number">2</span>, max_channels) <span class="hljs-operator">*</span> width, <span class="hljs-number">8</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            args <span class="hljs-operator">=</span> [c<span class="hljs-number">1</span>, <span class="hljs-operator">*</span>args[<span class="hljs-number">1</span>:]]</div></div></li></ol></code><div class="hljs-button {2}" data-title="å¤åˆ¶" onclick="hljs.copyCode(event)"></div></pre> 
<h3><a name="t9"></a>2.3&nbsp;&nbsp;yolov8_PolarizedSelfAttention.yaml</h3> 
<pre data-index="3" class="set-code-hide" name="code"><code class="hljs language-cobol"><ol class="hljs-ln" style="width:1052px"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># Ultralytics YOLO ğŸš€, GPL-<span class="hljs-number">3.0</span> license</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># YOLOv<span class="hljs-number">8</span> <span class="hljs-keyword">object</span> detection model <span class="hljs-keyword">with</span> P<span class="hljs-number">3</span>-P<span class="hljs-number">5</span> outputs. <span class="hljs-keyword">For</span> <span class="hljs-keyword">Usage</span> examples see https:<span class="hljs-operator">/</span><span class="hljs-operator">/</span>docs.ultralytics.com<span class="hljs-operator">/</span>tasks<span class="hljs-operator">/</span>detect</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># Parameters</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">nc: <span class="hljs-number">4</span>  # <span class="hljs-keyword">number</span> <span class="hljs-keyword">of</span> classes</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">scales: # model compound scaling constants, i.e. <span class="hljs-string">'model=yolov8n.yaml'</span> will <span class="hljs-keyword">call</span> yolov<span class="hljs-number">8</span>.yaml <span class="hljs-keyword">with</span> scale <span class="hljs-string">'n'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  # [depth, width, max_channels]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  n: [<span class="hljs-number">0.33</span>, <span class="hljs-number">0.25</span>, <span class="hljs-number">1024</span>]  # YOLOv<span class="hljs-number">8</span>n summary: <span class="hljs-number">225</span> layers,  <span class="hljs-number">3157200</span> parameters,  <span class="hljs-number">3157184</span> gradients,   <span class="hljs-number">8.9</span> GFLOPs</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  s: [<span class="hljs-number">0.33</span>, <span class="hljs-number">0.50</span>, <span class="hljs-number">1024</span>]  # YOLOv<span class="hljs-number">8</span>s summary: <span class="hljs-number">225</span> layers, <span class="hljs-number">11166560</span> parameters, <span class="hljs-number">11166544</span> gradients,  <span class="hljs-number">28.8</span> GFLOPs</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  m: [<span class="hljs-number">0.67</span>, <span class="hljs-number">0.75</span>, <span class="hljs-number">768</span>]   # YOLOv<span class="hljs-number">8</span>m summary: <span class="hljs-number">295</span> layers, <span class="hljs-number">25902640</span> parameters, <span class="hljs-number">25902624</span> gradients,  <span class="hljs-number">79.3</span> GFLOPs</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  l: [<span class="hljs-number">1.00</span>, <span class="hljs-number">1.00</span>, <span class="hljs-number">512</span>]   # YOLOv<span class="hljs-number">8</span>l summary: <span class="hljs-number">365</span> layers, <span class="hljs-number">43691520</span> parameters, <span class="hljs-number">43691504</span> gradients, <span class="hljs-number">165.7</span> GFLOPs</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  x: [<span class="hljs-number">1.00</span>, <span class="hljs-number">1.25</span>, <span class="hljs-number">512</span>]   # YOLOv<span class="hljs-number">8</span>x summary: <span class="hljs-number">365</span> layers, <span class="hljs-number">68229648</span> parameters, <span class="hljs-number">68229632</span> gradients, <span class="hljs-number">258.5</span> GFLOPs</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># YOLOv<span class="hljs-number">8.0</span>n backbone</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">backbone:</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  # [<span class="hljs-keyword">from</span>, repeats, module, args]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, Conv, [<span class="hljs-number">64</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>]]  # <span class="hljs-number">0</span>-P<span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">2</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, Conv, [<span class="hljs-number">128</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>]]  # <span class="hljs-number">1</span>-P<span class="hljs-number">2</span><span class="hljs-operator">/</span><span class="hljs-number">4</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, C<span class="hljs-number">2</span>f, [<span class="hljs-number">128</span>, <span class="hljs-keyword">True</span>]]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, Conv, [<span class="hljs-number">256</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>]]  # <span class="hljs-number">3</span>-P<span class="hljs-number">3</span><span class="hljs-operator">/</span><span class="hljs-number">8</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">6</span>, C<span class="hljs-number">2</span>f, [<span class="hljs-number">256</span>, <span class="hljs-keyword">True</span>]]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, Conv, [<span class="hljs-number">512</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>]]  # <span class="hljs-number">5</span>-P<span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-number">16</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">6</span>, C<span class="hljs-number">2</span>f, [<span class="hljs-number">512</span>, <span class="hljs-keyword">True</span>]]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, Conv, [<span class="hljs-number">1024</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>]]  # <span class="hljs-number">7</span>-P<span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">32</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, C<span class="hljs-number">2</span>f, [<span class="hljs-number">1024</span>, <span class="hljs-keyword">True</span>]]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, SPPF, [<span class="hljs-number">1024</span>, <span class="hljs-number">5</span>]]  # <span class="hljs-number">9</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># YOLOv<span class="hljs-number">8.0</span>n head</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">head:</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, nn.Upsample, [None, <span class="hljs-number">2</span>, <span class="hljs-string">'nearest'</span>]]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[[-<span class="hljs-number">1</span>, <span class="hljs-number">6</span>], <span class="hljs-number">1</span>, Concat, [<span class="hljs-number">1</span>]]  # cat backbone P<span class="hljs-number">4</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, C<span class="hljs-number">2</span>f, [<span class="hljs-number">512</span>]]  # <span class="hljs-number">12</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, nn.Upsample, [None, <span class="hljs-number">2</span>, <span class="hljs-string">'nearest'</span>]]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="35"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[[-<span class="hljs-number">1</span>, <span class="hljs-number">4</span>], <span class="hljs-number">1</span>, Concat, [<span class="hljs-number">1</span>]]  # cat backbone P<span class="hljs-number">3</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="36"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, C<span class="hljs-number">2</span>f, [<span class="hljs-number">256</span>]]  # <span class="hljs-number">15</span> (P<span class="hljs-number">3</span><span class="hljs-operator">/</span><span class="hljs-number">8</span>-small)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="37"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, PolarizedSelfAttention, [<span class="hljs-number">256</span>]]   # <span class="hljs-number">16</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="38"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="39"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, Conv, [<span class="hljs-number">256</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>]]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="40"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[[-<span class="hljs-number">1</span>, <span class="hljs-number">12</span>], <span class="hljs-number">1</span>, Concat, [<span class="hljs-number">1</span>]]  # cat head P<span class="hljs-number">4</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="41"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, C<span class="hljs-number">2</span>f, [<span class="hljs-number">512</span>]]  # <span class="hljs-number">19</span> (P<span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-number">16</span>-medium)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="42"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, PolarizedSelfAttention, [<span class="hljs-number">512</span>]]  </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="43"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="44"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, Conv, [<span class="hljs-number">512</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>]]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="45"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[[-<span class="hljs-number">1</span>, <span class="hljs-number">9</span>], <span class="hljs-number">1</span>, Concat, [<span class="hljs-number">1</span>]]  # cat head P<span class="hljs-number">5</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="46"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, C<span class="hljs-number">2</span>f, [<span class="hljs-number">1024</span>]]  # <span class="hljs-number">23</span> (P<span class="hljs-number">5</span><span class="hljs-operator">/</span><span class="hljs-number">32</span>-large)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="47"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[-<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, PolarizedSelfAttention, [<span class="hljs-number">1024</span>]]  </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="48"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="49"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> <span class="hljs-operator"> - </span>[[<span class="hljs-number">16</span>, <span class="hljs-number">20</span>, <span class="hljs-number">24</span>], <span class="hljs-number">1</span>, Detect, [nc]]  # Detect(P<span class="hljs-number">3</span>, P<span class="hljs-number">4</span>, P<span class="hljs-number">5</span>)</div></div></li></ol></code><div class="hide-preCode-box"><span class="hide-preCode-bt" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}"><img class="look-more-preCode contentImg-no-view" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" title=""></span></div><div class="hljs-button {2}" data-title="å¤åˆ¶" onclick="hljs.copyCode(event)"></div></pre>
                </div><div data-report-view="{&quot;mod&quot;:&quot;1585297308_001&quot;,&quot;spm&quot;:&quot;1001.2101.3001.6548&quot;,&quot;dest&quot;:&quot;https://cv2023.blog.csdn.net/article/details/130560024&quot;,&quot;extend1&quot;:&quot;pc&quot;,&quot;ab&quot;:&quot;new&quot;}"><div></div></div>
        </div>