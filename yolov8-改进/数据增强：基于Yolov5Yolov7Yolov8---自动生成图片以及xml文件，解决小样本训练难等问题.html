<div id="article_content" class="article_content clearfix">
        <link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/kdoc_html_views-1a98987dfd.css">
        <link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/ck_htmledit_views-dc4a025e85.css">
                <div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="" style="margin: 0px 0px 2px; padding-left: 24px;"><a href="#1.%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA%28Data%20Augmentation%29" target="_self">1.æ•°æ®å¢å¼º(Data Augmentation)</a></p> 
<p id="" style="margin: 0px 0px 2px; padding-left: 24px;"><a href="#t1" target="_self">2.è‡ªåŠ¨ç”Ÿæˆå›¾ç‰‡å’Œxmlæ–‡ä»¶</a></p> 
<p id="" style="margin: 0px 0px 2px 48px; padding-left: 24px;"><a href="#t2" target="_self">2.1 Gammaå˜åŒ–æ•°æ®å¢å¼º</a></p> 
<p id="" style="margin: 0px 0px 2px 48px; padding-left: 24px;"><a href="#t3" target="_self">2.2 æ»¤æ³¢ç±»æ•°æ®å¢å¼º: GaussianBlurã€medianBlurã€blur</a></p> 
<p id="" style="margin: 0px 0px 2px 48px; padding-left: 24px;"><a href="#t4" target="_self">2.3&nbsp; ç¼©æ”¾ç±»æ•°æ®å¢å¼º</a></p> 
<p id="" style="margin: 0px 0px 2px 48px; padding-left: 24px;"><a href="#t5" target="_self">2.4ç¿»è½¬ç±»æ•°æ®å¢å¼º</a></p> 
<p id="" style="margin: 0px 0px 2px 48px; padding-left: 24px;"><a href="#t6" target="_self">2.5 ä»»æ„è§’åº¦æ—‹è½¬æ•°æ®å¢å¼º</a></p> 
<hr id="hr-toc"> 
<h3><a name="t0"></a>&nbsp;ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†Yolov5/Yolov7é­”æœ¯å¸ˆğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ†<br> ğŸŒŸğŸŒŸğŸŒŸé­”æ”¹ç½‘ç»œå’Œå¤ç°cvprç­‰å‰æ²¿è®ºæ–‡ï¼Œç»„åˆä¼˜åŒ–<br> ğŸ‰ğŸ‰ğŸ‰ç‹¬å®¶é¦–åˆ›ï¼Œå¯ç›´æ¥ä½œä¸ºåˆ›æ–°ç‚¹ä½¿ç”¨<br> ğŸš€ğŸš€ğŸš€åœ¨å¤šä¸ªæ•°æ®é›†è¿›è¡ŒéªŒè¯mAPæ¶¨ç‚¹æ˜æ˜¾ï¼Œå°¤å…¶æ˜¯å°ç›®æ ‡ã€é®æŒ¡ç‰©ç²¾åº¦æå‡æ˜æ˜¾ï¼›&nbsp;<br> ğŸŒ° ğŸŒ° ğŸŒ°ğŸŒ° ğŸŒ° ğŸŒ°ğŸŒ° ğŸŒ° ğŸŒ°ğŸŒ° ğŸŒ° ğŸŒ°ğŸŒ° ğŸŒ° ğŸŒ°ğŸŒ° ğŸŒ° ğŸŒ°</h3> 
<h2><a name="t1"></a>1.å°æ ·æœ¬ç›®æ ‡æ£€æµ‹ä»‹ç»&nbsp; &nbsp; &nbsp;&nbsp;</h2> 
<p>&nbsp;&nbsp;å°æ ·æœ¬ç›®æ ‡æ£€æµ‹æ–¹æ³•ä¸»è¦åŸºäºä¼ ç»Ÿçš„ç»å…¸æˆç†Ÿçš„ç›®æ ‡æ£€æµ‹æ–¹æ³•ï¼Œå€Ÿé‰´å°æ ·æœ¬å­¦ä¹ æ¡†æ¶ï¼Œæ„å»ºé’ˆå¯¹ç›®æ ‡æ£€æµ‹çš„å°æ ·æœ¬è§£å†³æ–¹æ¡ˆã€‚ç°æœ‰çš„æ–¹æ³•ä¸»è¦å¯ä»¥åˆ†ä¸ºå…­ç§ï¼š</p> 
<p>ï¼ˆ1ï¼‰åŸºäºåº¦é‡å­¦ä¹ ï¼ˆmetric learningï¼‰çš„æ–¹æ³•<br> ï¼ˆ2ï¼‰<span style="color:#fe2c24;"><strong>åŸºäºæ•°æ®å¢å¼ºçš„æ–¹æ³•</strong></span><br> ï¼ˆ3ï¼‰åŸºäºæ¨¡å‹ç»“æ„çš„æ–¹æ³•<br> ï¼ˆ4ï¼‰åŸºäºå¾®è°ƒï¼ˆfine-tuneï¼‰çš„æ–¹æ³•<br> ï¼ˆ5ï¼‰åŸºäºå…ƒå­¦ä¹ çš„æ–¹æ³•<br> ï¼ˆ6ï¼‰åŸºäºé›†æˆçš„æ–¹æ³•</p> 
<h3><a name="t2"></a>1.1 å°æ ·æœ¬ç›®æ ‡æ£€æµ‹ç°æœ‰çš„é—®é¢˜</h3> 
<p>ï¼‘ã€ä¾èµ–äºä¼ ç»Ÿçš„ç›®æ ‡æ£€æµ‹é¢†åŸŸä¸­ç»å…¸æˆç†Ÿçš„æ–¹æ³•ï¼Œä½†æ˜¯åç»­çš„æ¨ç†é€Ÿåº¦ç¼“æ…¢ï¼Œä¸èƒ½æ»¡è¶³å®æ—¶æ€§éœ€æ±‚ã€‚</p> 
<p>ï¼’ã€ç°æœ‰çš„æ–¹æ³•æ³›åŒ–æ€§èƒ½å·®å¼ºäººæ„ï¼Œéšå°æ ·æœ¬ç±»åˆ«å¢åŠ ï¼Œæ•ˆæœä¸‹é™æ˜æ˜¾</p> 
<h3 id="1.%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA(Data%20Augmentation)"><a name="t3"></a>1.2 <a href="https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;æ•°æ®å¢å¼º\&quot;}&quot;}" data-tit="æ•°æ®å¢å¼º" data-pretit="æ•°æ®å¢å¼º">æ•°æ®å¢å¼º</a>(Data Augmentation)</h3> 
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æ•°æ®å¢å¼ºï¼ˆä¹Ÿå«æ•°æ®æ‰©å¢ï¼‰çš„ç›®çš„æ˜¯ä¸ºäº†æ‰©å……æ•°æ®å’Œæå‡æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚æœ‰æ•ˆçš„æ•°æ®æ‰©å……ä¸ä»…èƒ½æ‰©å……è®­ç»ƒæ ·æœ¬æ•°é‡ï¼Œè¿˜èƒ½å¢åŠ è®­ç»ƒæ ·æœ¬çš„å¤šæ ·æ€§ï¼Œä¸€æ–¹é¢å¯é¿å…è¿‡æ‹Ÿåˆï¼Œå¦ä¸€æ–¹é¢åˆä¼šå¸¦æ¥æ¨¡å‹æ€§èƒ½çš„æå‡ã€‚&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p> 
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æ•°æ®å¢å¼ºï¼ˆData Augmentationï¼‰æ˜¯ä¸€ç§ä½¿ç”¨å°‘é‡æ•°æ®é€šè¿‡å…ˆéªŒçŸ¥è¯†äº§ç”Ÿæ›´å¤šçš„ç›¸ä¼¼ç”Ÿæˆæ•°æ®æ¥æ‰©å±•è®­ç»ƒæ•°æ®é›†çš„æ–¹æ³•ã€‚ æ•°æ®å¢å¼ºæ–¹æ³•å¸¸ç”¨äºè§£å†³ç°å®ä¸šåŠ¡ä¸­çš„å°æ ·æœ¬é—®é¢˜ã€‚</p> 
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;æ•°æ®å¢å¼ºå‡ ç§å¸¸ç”¨æ–¹æ³•æœ‰: å›¾åƒæ°´å¹³/ç«–ç›´ç¿»è½¬ã€éšæœºæŠ å–ã€å°ºåº¦å˜æ¢å’Œæ—‹è½¬ã€‚å…¶ä¸­å°ºåº¦å˜æ¢ï¼ˆscalingï¼‰ã€æ—‹è½¬ï¼ˆrotatingï¼‰ç­‰æ–¹æ³•ç”¨æ¥å¢åŠ å·ç§¯å·ç§¯ç¥ç»ç½‘ç»œå¯¹ç‰©ä½“å°ºåº¦å’Œæ–¹å‘ä¸Šçš„é²æ£’æ€§ã€‚</p> 
<p><img alt="" height="518" src="https://img-blog.csdnimg.cn/1d4f11e963eb43d8b685121df8b9dcfa.png" width="1200"></p> 
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;å°æ ·æœ¬å­¦ä¹ ä¸»è¦é—®é¢˜æ˜¯æ ·æœ¬é‡è¿‡å°‘ï¼Œä»è€Œå¯¼è‡´æ ·æœ¬å¤šæ ·æ€§ä¸è¶³ä»¥åˆ»ç”»å®Œæ•´æ ·æœ¬åˆ†å¸ƒï¼Œå¯ä»¥é€šè¿‡æ ·æœ¬å¢å¼ºæ¥æå‡æ ·æœ¬å¤šæ ·æ€§ï¼›åŸºäºæ•°æ®å¢å¼ºçš„æ–¹æ³•æ˜¯åˆ©ç”¨è¾…åŠ©æ•°æ®é›†æˆ–è€…è¾…åŠ©ä¿¡æ¯å¢å¼ºç›®æ ‡æ•°æ®é›†ä¸­è¿›è¡Œæ•°æ®æ‰©å…… æˆ–ç‰¹å¾å¢å¼ºï¼Œä½¿æ¨¡å‹èƒ½æ›´å¥½æ‹Ÿåˆã€‚æ•°æ®æ‰©å……å¯ä»¥æ˜¯æ— æ ‡ç­¾æˆ–è€…åˆæˆå¸¦æ ‡ç­¾æ•°æ®ï¼›ç‰¹å¾å¢å¼ºæ˜¯åœ¨åŸæ ·æœ¬çš„ç‰¹å¾ç©ºé—´ä¸­æ·»åŠ ä¾¿äºåˆ†ç±»çš„ç‰¹å¾ï¼Œå¢åŠ ç‰¹å¾å¤šæ ·æ€§ï¼›</p> 
<h2 id="2.%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E5%9B%BE%E7%89%87%E5%92%8Cxml%E6%96%87%E4%BB%B6"><a name="t4"></a>2.è‡ªåŠ¨ç”Ÿæˆå›¾ç‰‡å’Œxmlæ–‡ä»¶</h2> 
<h3 id="2.1%20Gamma%E5%8F%98%E5%8C%96%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA"><a name="t5"></a>2.1 <a href="https://so.csdn.net/so/search?q=Gamma&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=Gamma&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;Gamma\&quot;}&quot;}" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=Gamma&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;Gamma\&quot;}&quot;}" data-tit="Gamma" data-pretit="gamma">Gamma</a>å˜åŒ–æ•°æ®å¢å¼º</h3> 
<p>é€šè¿‡&nbsp;aaå’Œggä¸¤ä¸ªå˜åŒ–è°ƒæ•´gammaå˜åŒ–çš„ç¨‹åº¦</p> 
<pre data-index="0" class="set-code-hide" name="code"><code class="hljs language-cobol"><ol class="hljs-ln" style="width:100%"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># -<span class="hljs-operator">*</span>- coding: utf-<span class="hljs-number">8</span> -<span class="hljs-operator">*</span>-</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">""</span><span class="hljs-string"><span class="hljs-string">"</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">Created on Fri Jun 01 15:24:21 2018</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string"></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">@author: AI&amp;CV</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">"</span><span class="hljs-string">""</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import cv<span class="hljs-number">2</span>  </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import numpy <span class="hljs-keyword">as</span> np </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import xml.etree.ElementTree <span class="hljs-keyword">as</span> ET</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import os</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">from</span> skimage import  exposure</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">xmlpath <span class="hljs-operator">=</span> <span class="hljs-string">'./VOC2007/Annotations/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">imgpath <span class="hljs-operator">=</span> <span class="hljs-string">'./VOC2007/JPEGImages/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">hist_imgpath <span class="hljs-operator">=</span> <span class="hljs-string">'./VOC2007/gammma/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">hist_xmlpath <span class="hljs-operator">=</span> <span class="hljs-string">'./xmlgammma/'</span> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> os.listdir(imgpath):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    a, b <span class="hljs-operator">=</span> os.path.splitext(i) </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    img <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.imread(imgpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'.jpg'</span>,<span class="hljs-number">0</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">   #################</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    w <span class="hljs-operator">=</span> img.shape[<span class="hljs-number">1</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    h <span class="hljs-operator">=</span> img.shape[<span class="hljs-number">0</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    img<span class="hljs-number">2</span> <span class="hljs-operator">=</span> np.<span class="hljs-literal">zeros</span>([h, w], img.dtype)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    aa<span class="hljs-operator">=</span><span class="hljs-number">1.1</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    gg<span class="hljs-operator">=</span><span class="hljs-number">5</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    img<span class="hljs-number">1</span> <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.addWeighted(img, aa, img<span class="hljs-number">2</span>, <span class="hljs-number">1</span>-aa, gg)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    ########################</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">  </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="35"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    #img<span class="hljs-number">1</span> <span class="hljs-operator">=</span> exposure.adjust_gamma(img,<span class="hljs-number">0.9</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="36"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="37"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    #img<span class="hljs-number">1</span><span class="hljs-operator">=</span> exposure.adjust_log(img)   #å¯¹æ•°è°ƒæ•´</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="38"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    cv<span class="hljs-number">2</span>.imwrite(hist_imgpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'_gamma'</span><span class="hljs-operator">+</span> str(<span class="hljs-number">1</span>) <span class="hljs-operator">+</span><span class="hljs-string">'_'</span><span class="hljs-operator">+</span> str(<span class="hljs-number">9</span>)<span class="hljs-operator">+</span><span class="hljs-string">'.jpg'</span>,img<span class="hljs-number">1</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="39"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">   </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="40"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    tree <span class="hljs-operator">=</span> ET.parse(xmlpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'.xml'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="41"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    root <span class="hljs-operator">=</span> tree.getroot()</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="42"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="43"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword">for</span> <span class="hljs-keyword">file</span><span class="hljs-number">1</span> <span class="hljs-keyword">in</span> root.findall(<span class="hljs-string">'filename'</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="44"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            #filename<span class="hljs-operator">=</span>str(<span class="hljs-keyword">file</span><span class="hljs-number">1</span>.find(<span class="hljs-string">'filename'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="45"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-keyword">file</span><span class="hljs-number">1</span>.text <span class="hljs-operator">=</span> str(a <span class="hljs-operator">+</span> <span class="hljs-string">'_gamma'</span><span class="hljs-operator">+</span> str(<span class="hljs-number">1</span>) <span class="hljs-operator">+</span><span class="hljs-string">'_'</span><span class="hljs-operator">+</span> str(<span class="hljs-number">9</span>)<span class="hljs-operator">+</span><span class="hljs-string">'.jpg'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="46"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="47"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    tree.<span class="hljs-keyword">write</span>(hist_xmlpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'_gamma'</span><span class="hljs-operator">+</span> str(<span class="hljs-number">1</span>) <span class="hljs-operator">+</span><span class="hljs-string">'_'</span><span class="hljs-operator">+</span> str(<span class="hljs-number">9</span>) <span class="hljs-operator">+</span><span class="hljs-string">'.xml'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="48"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    print( str(a) <span class="hljs-operator">+</span> <span class="hljs-string">'.xml has been gamma  '</span>)</div></div></li></ol></code><div class="hide-preCode-box"><span class="hide-preCode-bt" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}"><img class="look-more-preCode contentImg-no-view" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" title=""></span></div><div class="hljs-button {2}" data-title="å¤åˆ¶" onclick="hljs.copyCode(event)"></div></pre> 
<h3 id="2.2%20%E6%BB%A4%E6%B3%A2%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA%3A%20GaussianBlur%E3%80%81medianBlur%E3%80%81blur"><a name="t6"></a>2.2 <a href="https://so.csdn.net/so/search?q=%E6%BB%A4%E6%B3%A2&amp;spm=1001.2101.3001.7020" target="_blank" class="hl hl-1" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=%E6%BB%A4%E6%B3%A2&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;æ»¤æ³¢\&quot;}&quot;}" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.7020&quot;,&quot;dest&quot;:&quot;https://so.csdn.net/so/search?q=%E6%BB%A4%E6%B3%A2&amp;spm=1001.2101.3001.7020&quot;,&quot;extra&quot;:&quot;{\&quot;searchword\&quot;:\&quot;æ»¤æ³¢\&quot;}&quot;}" data-tit="æ»¤æ³¢" data-pretit="æ»¤æ³¢">æ»¤æ³¢</a>ç±»æ•°æ®å¢å¼º: GaussianBlurã€medianBlurã€blur</h3> 
<pre data-index="1" class="set-code-hide" name="code"><code class="hljs language-cobol"><ol class="hljs-ln" style="width:100%"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># -<span class="hljs-operator">*</span>- coding: utf-<span class="hljs-number">8</span> -<span class="hljs-operator">*</span>-</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">""</span><span class="hljs-string"><span class="hljs-string">"</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">Created on Fri Jun 01 15:24:21 2018</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string"></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">@author: AI&amp;CV</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">"</span><span class="hljs-string">""</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import cv<span class="hljs-number">2</span>  </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import numpy <span class="hljs-keyword">as</span> np </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import xml.etree.ElementTree <span class="hljs-keyword">as</span> ET</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import os</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">from</span> skimage import  exposure</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">xmlpath <span class="hljs-operator">=</span> <span class="hljs-string">'./Annotations/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">imgpath <span class="hljs-operator">=</span> <span class="hljs-string">'./JPEGImages/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">blur_imgpath <span class="hljs-operator">=</span> <span class="hljs-string">'./motionblur/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">blur_xmlpath <span class="hljs-operator">=</span> <span class="hljs-string">'./xmlmotion/'</span> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> os.listdir(imgpath):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    a, b <span class="hljs-operator">=</span> os.path.splitext(i) </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    img <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.imread(imgpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'.jpg'</span>,<span class="hljs-number">1</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    #img<span class="hljs-number">1</span> <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.bilateralFilter(img,<span class="hljs-number">15,15,2,4</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    img<span class="hljs-number">1</span> <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.blur(img,(<span class="hljs-number">3,3</span>));</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    #img<span class="hljs-number">1</span> <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.GaussianBlur(img,(<span class="hljs-number">3,3</span>),<span class="hljs-number">3</span>); #(<span class="hljs-number">9,9</span>),<span class="hljs-number">5</span><span class="hljs-keyword">and</span><span class="hljs-number">3</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    #img<span class="hljs-number">1</span> <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.medianBlur(img,<span class="hljs-number">3</span>);</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    cv<span class="hljs-number">2</span>.imwrite(blur_imgpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'_blur_'</span><span class="hljs-operator">+</span>str(<span class="hljs-number">3</span>) <span class="hljs-operator">+</span><span class="hljs-string">'.jpg'</span>,img<span class="hljs-number">1</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    tree <span class="hljs-operator">=</span> ET.parse(xmlpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'.xml'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    root <span class="hljs-operator">=</span> tree.getroot()</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword">for</span> <span class="hljs-keyword">file</span><span class="hljs-number">1</span> <span class="hljs-keyword">in</span> root.findall(<span class="hljs-string">'filename'</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="35"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            #filename<span class="hljs-operator">=</span>str(<span class="hljs-keyword">file</span><span class="hljs-number">1</span>.find(<span class="hljs-string">'filename'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="36"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-keyword">file</span><span class="hljs-number">1</span>.text <span class="hljs-operator">=</span> str(a <span class="hljs-operator">+</span> <span class="hljs-string">'_blur_'</span> <span class="hljs-operator">+</span>str(<span class="hljs-number">3</span>)<span class="hljs-operator">+</span><span class="hljs-string">'.jpg'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="37"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="38"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="39"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    tree.<span class="hljs-keyword">write</span>(blur_xmlpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'_blur_'</span> <span class="hljs-operator">+</span>str(<span class="hljs-number">3</span>) <span class="hljs-operator">+</span><span class="hljs-string">'.xml'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="40"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    print( str(a) <span class="hljs-operator">+</span> <span class="hljs-string">'.xml has been gamma  '</span>)</div></div></li></ol></code><div class="hide-preCode-box"><span class="hide-preCode-bt" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}"><img class="look-more-preCode contentImg-no-view" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" title=""></span></div><div class="hljs-button {2}" data-title="å¤åˆ¶" onclick="hljs.copyCode(event)"></div></pre> 
<h3 id="2.3%C2%A0%20%E7%BC%A9%E6%94%BE%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA"><a name="t7"></a>2.3&nbsp; ç¼©æ”¾ç±»æ•°æ®å¢å¼º</h3> 
<pre data-index="2" class="set-code-hide" name="code"><code class="hljs language-python"><ol class="hljs-ln" style="width:100%"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-comment"># -*- coding: utf-8 -*-</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string"><span class="hljs-string">"""</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">Created on Mon Apr 09 09:48:50 2018</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string"></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">@author: AI&amp;CV</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">"""</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">import</span> cv2</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">import</span> math</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">import</span> xml.etree.ElementTree <span class="hljs-keyword">as</span> ET</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">import</span> os</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">      </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">xmlpath = <span class="hljs-string">'./Annotations/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">imgpath = <span class="hljs-string">'./JPEGImages/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">resize_imgpath = <span class="hljs-string">'./resize/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">rotated_xmlpath = <span class="hljs-string">'./resizexml/'</span> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> os.listdir(imgpath):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        a, b = os.path.splitext(i)                            <span class="hljs-comment">#åˆ†ç¦»å‡ºæ–‡ä»¶åa</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        img = cv2.imread(imgpath + a + <span class="hljs-string">'.jpg'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        w = img.shape[<span class="hljs-number">1</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        h = img.shape[<span class="hljs-number">0</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        scale_h=<span class="hljs-number">0.98</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        scale_w=<span class="hljs-number">0.98</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        resize_img=cv2.resize(img, (<span class="hljs-built_in">int</span>(w*scale_w), <span class="hljs-built_in">int</span>(h*scale_h)), interpolation=cv2.INTER_CUBIC)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        cv2.imwrite(resize_imgpath + a + <span class="hljs-string">'_'</span>+ <span class="hljs-built_in">str</span>(<span class="hljs-number">98</span>) +<span class="hljs-string">'.jpg'</span>,resize_img)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-comment">#print str(i) + ' has been rotated for '+ st12Â°'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        tree = ET.parse(xmlpath + a + <span class="hljs-string">'.xml'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        root = tree.getroot()</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="35"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">for</span> file1 <span class="hljs-keyword">in</span> root.findall(<span class="hljs-string">'filename'</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="36"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-comment">#filename=str(file1.find('filename').text)</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="37"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            file1.text = <span class="hljs-built_in">str</span>(a + <span class="hljs-string">'_'</span>+ <span class="hljs-built_in">str</span>(<span class="hljs-number">98</span>)+<span class="hljs-string">'.jpg'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="38"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">           </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="39"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">       </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="40"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">for</span> box <span class="hljs-keyword">in</span> root.<span class="hljs-built_in">iter</span>(<span class="hljs-string">'bndbox'</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="41"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            xmin = <span class="hljs-built_in">float</span>(box.find(<span class="hljs-string">'xmin'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="42"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            ymin = <span class="hljs-built_in">float</span>(box.find(<span class="hljs-string">'ymin'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="43"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            xmax = <span class="hljs-built_in">float</span>(box.find(<span class="hljs-string">'xmax'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="44"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            ymax = <span class="hljs-built_in">float</span>(box.find(<span class="hljs-string">'ymax'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="45"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            x=<span class="hljs-built_in">int</span>(xmin*scale_h)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="46"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            y=<span class="hljs-built_in">int</span>(ymin*scale_w)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="47"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            x1=<span class="hljs-built_in">int</span>(xmax*scale_h)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="48"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            y1=<span class="hljs-built_in">int</span>(ymax*scale_w)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="49"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            cv2.rectangle(resize_img, (x, y), (x1, y1), [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>], <span class="hljs-number">2</span>)   <span class="hljs-comment">#å¯åœ¨è¯¥æ­¥éª¤æµ‹è¯•æ–°ç”»çš„æ¡†ä½ç½®æ˜¯å¦æ­£ç¡®</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="50"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-comment"># cv2.imshow('xmlbnd',rotated_img)</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="51"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-comment"># cv2.waitKey(200)</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="52"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'xmin'</span>).text = <span class="hljs-built_in">str</span>(x)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="53"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'ymin'</span>).text = <span class="hljs-built_in">str</span>(y)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="54"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'xmax'</span>).text = <span class="hljs-built_in">str</span>(x1)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="55"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'ymax'</span>).text = <span class="hljs-built_in">str</span>(y1)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="56"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-comment">#cv2.imwrite("E:/test/VOC07/3/" + a + "_" + str(1000) +".jpg",resize_img)</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="57"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        tree.write(rotated_xmlpath + a + <span class="hljs-string">'_'</span>+ <span class="hljs-built_in">str</span>(<span class="hljs-number">98</span>) +<span class="hljs-string">'.xml'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="58"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-built_in">print</span> (<span class="hljs-built_in">str</span>(a) + <span class="hljs-string">'.xml has been rotated for '</span>+ <span class="hljs-built_in">str</span>(<span class="hljs-number">98</span>))</div></div></li></ol></code><div class="hide-preCode-box"><span class="hide-preCode-bt" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}"><img class="look-more-preCode contentImg-no-view" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" title=""></span></div><div class="hljs-button {2}" data-title="å¤åˆ¶" onclick="hljs.copyCode(event)"></div></pre> 
<h3 id="2.4%E7%BF%BB%E8%BD%AC%E7%B1%BB%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA"><a name="t8"></a>2.4ç¿»è½¬ç±»æ•°æ®å¢å¼º</h3> 
<pre data-index="3" class="set-code-hide" name="code"><code class="hljs language-cobol"><ol class="hljs-ln" style="width:100%"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># -<span class="hljs-operator">*</span>- coding: utf-<span class="hljs-number">8</span> -<span class="hljs-operator">*</span>-</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">""</span><span class="hljs-string"><span class="hljs-string">"</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">Created on Sun Apr 08 18:27:53 2018</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string"></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">@author: AI&amp;CV</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">"</span><span class="hljs-string">""</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import cv<span class="hljs-number">2</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import math</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import numpy <span class="hljs-keyword">as</span> np</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import xml.etree.ElementTree <span class="hljs-keyword">as</span> ET</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import os</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">def GetUDFlipLoc(h, xmin, ymin, xmax, ymax):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    H<span class="hljs-operator">=</span>h </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    NewXmin<span class="hljs-operator">=</span>xmin</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    NewYmin<span class="hljs-operator">=</span>H-ymax</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    NewXmax<span class="hljs-operator">=</span>xmax</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    NewYmax<span class="hljs-operator">=</span>H-ymin</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> NewXmin,NewYmin,NewXmax,NewYmax</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">xmlpath <span class="hljs-operator">=</span> <span class="hljs-string">'./Annotations/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">imgpath <span class="hljs-operator">=</span> <span class="hljs-string">'./JPEGImages/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">rotated_imgpath <span class="hljs-operator">=</span> <span class="hljs-string">'./motionblur/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">rotated_xmlpath <span class="hljs-operator">=</span> <span class="hljs-string">'./xmlmotion/'</span> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> os.listdir(imgpath):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    a, b <span class="hljs-operator">=</span> os.path.splitext(i)                            </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        #img <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.imread(imgpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'.jpg'</span>,<span class="hljs-number">0</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    img <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.imread(imgpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'.bmp'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="35"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    w <span class="hljs-operator">=</span> img.shape[<span class="hljs-number">1</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="36"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    h <span class="hljs-operator">=</span> img.shape[<span class="hljs-number">0</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="37"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    UDFlipIm<span class="hljs-operator">=</span>cv<span class="hljs-number">2</span>.flip(img,<span class="hljs-number">1</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="38"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    cv<span class="hljs-number">2</span>.imwrite(rotated_imgpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'_flip'</span> <span class="hljs-operator">+</span><span class="hljs-string">'.bmp'</span>,UDFlipIm)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="39"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    tree <span class="hljs-operator">=</span> ET.parse(xmlpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'.xml'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="40"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    root <span class="hljs-operator">=</span> tree.getroot()</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="41"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="42"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword">for</span> <span class="hljs-keyword">file</span><span class="hljs-number">1</span> <span class="hljs-keyword">in</span> root.findall(<span class="hljs-string">'filename'</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="43"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            #filename<span class="hljs-operator">=</span>str(<span class="hljs-keyword">file</span><span class="hljs-number">1</span>.find(<span class="hljs-string">'filename'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="44"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">file</span><span class="hljs-number">1</span>.text <span class="hljs-operator">=</span> str(a <span class="hljs-operator">+</span> <span class="hljs-string">'_flip'</span><span class="hljs-operator">+</span><span class="hljs-string">'.bmp'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="45"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="46"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">for</span> box <span class="hljs-keyword">in</span> root.iter(<span class="hljs-string">'bndbox'</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="47"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            xmin <span class="hljs-operator">=</span> int(box.find(<span class="hljs-string">'xmin'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="48"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            ymin <span class="hljs-operator">=</span> int(box.find(<span class="hljs-string">'ymin'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="49"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            xmax <span class="hljs-operator">=</span> int(box.find(<span class="hljs-string">'xmax'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="50"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            ymax <span class="hljs-operator">=</span> int(box.find(<span class="hljs-string">'ymax'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="51"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            NewXmin, NewYmin, NewXmax, NewYmax <span class="hljs-operator">=</span> GetUDFlipLoc(h, xmin, ymin, xmax, ymax)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="52"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'xmin'</span>).text <span class="hljs-operator">=</span> str(NewXmin)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="53"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'ymin'</span>).text <span class="hljs-operator">=</span> str(NewYmin)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="54"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'xmax'</span>).text <span class="hljs-operator">=</span> str(NewXmax)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="55"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'ymax'</span>).text <span class="hljs-operator">=</span> str(NewYmax)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="56"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        #cv<span class="hljs-number">2</span>.imwrite(<span class="hljs-string">"E:/test/VOC07/3/"</span> <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">"_"</span> <span class="hljs-operator">+</span> str(angle) <span class="hljs-operator">+</span><span class="hljs-string">".jpg"</span>,rotated_img)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="57"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        tree.<span class="hljs-keyword">write</span>(rotated_xmlpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'_flip'</span> <span class="hljs-operator">+</span><span class="hljs-string">'.xml'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="58"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        print (str(a) <span class="hljs-operator">+</span> <span class="hljs-string">'.xml has been flip for '</span><span class="hljs-operator">+</span> <span class="hljs-string">'_flip'</span><span class="hljs-operator">+</span><span class="hljs-string">'Â°'</span>)</div></div></li></ol></code><div class="hide-preCode-box"><span class="hide-preCode-bt" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}"><img class="look-more-preCode contentImg-no-view" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" title=""></span></div><div class="hljs-button {2}" data-title="å¤åˆ¶" onclick="hljs.copyCode(event)"></div></pre> 
<h3 id="2.5%20%E4%BB%BB%E6%84%8F%E8%A7%92%E5%BA%A6%E6%97%8B%E8%BD%AC%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA"><a name="t9"></a>2.5 ä»»æ„è§’åº¦æ—‹è½¬æ•°æ®å¢å¼º</h3> 
<pre data-index="4" class="set-code-hide" name="code"><code class="hljs language-cobol"><ol class="hljs-ln hundred" style="width:1281px"><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># -<span class="hljs-operator">*</span>- coding: utf-<span class="hljs-number">8</span> -<span class="hljs-operator">*</span>-</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="2"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">""</span><span class="hljs-string"><span class="hljs-string">"</span></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="3"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">Created on Sun Apr 08 18:27:53 2018</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="4"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string"></span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="5"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">@author: AI&amp;CV</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="6"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-string">"</span><span class="hljs-string">""</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="7"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="8"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import cv<span class="hljs-number">2</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="9"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import math</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="10"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import numpy <span class="hljs-keyword">as</span> np</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="11"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import xml.etree.ElementTree <span class="hljs-keyword">as</span> ET</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="12"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">import os</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="13"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="14"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="15"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">def rotate_image(src, angle, scale<span class="hljs-operator">=</span><span class="hljs-number">1</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="16"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    w <span class="hljs-operator">=</span> src.shape[<span class="hljs-number">1</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="17"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    h <span class="hljs-operator">=</span> src.shape[<span class="hljs-number">0</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="18"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # è§’åº¦å˜å¼§åº¦</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="19"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rangle <span class="hljs-operator">=</span> np.deg<span class="hljs-number">2</span>rad(angle)  # angle <span class="hljs-keyword">in</span> radians</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="20"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # now calculate new image width <span class="hljs-keyword">and</span> height</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="21"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    nw <span class="hljs-operator">=</span> (abs(np.sin(rangle) <span class="hljs-operator">*</span> h) <span class="hljs-operator">+</span> abs(np.cos(rangle) <span class="hljs-operator">*</span> w)) <span class="hljs-operator">*</span> scale</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="22"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    nh <span class="hljs-operator">=</span> (abs(np.cos(rangle) <span class="hljs-operator">*</span> h) <span class="hljs-operator">+</span> abs(np.sin(rangle) <span class="hljs-operator">*</span> w)) <span class="hljs-operator">*</span> scale</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="23"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # ask OpenCV <span class="hljs-keyword">for</span> the rotation matrix</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="24"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rot_mat <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.getRotationMatrix<span class="hljs-number">2</span>D((nw <span class="hljs-operator">*</span> <span class="hljs-number">0.5</span>, nh <span class="hljs-operator">*</span> <span class="hljs-number">0.5</span>), angle, scale)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="25"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # calculate the <span class="hljs-keyword">move</span> <span class="hljs-keyword">from</span> the old center <span class="hljs-keyword">to</span> the new center combined</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="26"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # <span class="hljs-keyword">with</span> the rotation</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="27"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rot_<span class="hljs-keyword">move</span> <span class="hljs-operator">=</span> np.dot(rot_mat, np.array([(nw<span class="hljs-operator"> - </span>w) <span class="hljs-operator">*</span> <span class="hljs-number">0.5</span>, (nh<span class="hljs-operator"> - </span>h) <span class="hljs-operator">*</span> <span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>]))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="28"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # the <span class="hljs-keyword">move</span> only affects the translation, so update the translation</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="29"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # part <span class="hljs-keyword">of</span> the transform</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="30"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rot_mat[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>] <span class="hljs-operator">+</span><span class="hljs-operator">=</span> rot_<span class="hljs-keyword">move</span>[<span class="hljs-number">0</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="31"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rot_mat[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>] <span class="hljs-operator">+</span><span class="hljs-operator">=</span> rot_<span class="hljs-keyword">move</span>[<span class="hljs-number">1</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="32"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    dst <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.warpAffine(src, rot_mat, (int(math.ceil(nw)), int(math.ceil(nh))), flags<span class="hljs-operator">=</span>cv<span class="hljs-number">2</span>.INTER_LANCZOS<span class="hljs-number">4</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="33"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # ä»¿å°„å˜æ¢</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="34"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> dst</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="35"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="36"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># å¯¹åº”ä¿®æ”¹xmlæ–‡ä»¶</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="37"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">def rotate_xml(src, xmin, ymin, xmax, ymax, angle, scale<span class="hljs-operator">=</span><span class="hljs-number">1</span>.):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="38"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    w <span class="hljs-operator">=</span> src.shape[<span class="hljs-number">1</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="39"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    h <span class="hljs-operator">=</span> src.shape[<span class="hljs-number">0</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="40"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rangle <span class="hljs-operator">=</span> np.deg<span class="hljs-number">2</span>rad(angle)  # angle <span class="hljs-keyword">in</span> radians</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="41"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # now calculate new image width <span class="hljs-keyword">and</span> height</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="42"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # è·å–æ—‹è½¬åå›¾åƒçš„é•¿å’Œå®½</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="43"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    nw <span class="hljs-operator">=</span> (abs(np.sin(rangle)<span class="hljs-operator">*</span>h) <span class="hljs-operator">+</span> abs(np.cos(rangle)<span class="hljs-operator">*</span>w))<span class="hljs-operator">*</span>scale</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="44"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    nh <span class="hljs-operator">=</span> (abs(np.cos(rangle)<span class="hljs-operator">*</span>h) <span class="hljs-operator">+</span> abs(np.sin(rangle)<span class="hljs-operator">*</span>w))<span class="hljs-operator">*</span>scale</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="45"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # ask OpenCV <span class="hljs-keyword">for</span> the rotation matrix</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="46"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rot_mat <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.getRotationMatrix<span class="hljs-number">2</span>D((nw<span class="hljs-operator">*</span><span class="hljs-number">0.5</span>, nh<span class="hljs-operator">*</span><span class="hljs-number">0.5</span>), angle, scale)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="47"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # calculate the <span class="hljs-keyword">move</span> <span class="hljs-keyword">from</span> the old center <span class="hljs-keyword">to</span> the new center combined</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="48"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # <span class="hljs-keyword">with</span> the rotation</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="49"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rot_<span class="hljs-keyword">move</span> <span class="hljs-operator">=</span> np.dot(rot_mat, np.array([(nw-w)<span class="hljs-operator">*</span><span class="hljs-number">0.5</span>, (nh-h)<span class="hljs-operator">*</span><span class="hljs-number">0.5,0</span>]))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="50"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # the <span class="hljs-keyword">move</span> only affects the translation, so update the translation</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="51"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # part <span class="hljs-keyword">of</span> the transform</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="52"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rot_mat[<span class="hljs-number">0</span>, <span class="hljs-number">2</span>] <span class="hljs-operator">+</span><span class="hljs-operator">=</span> rot_<span class="hljs-keyword">move</span>[<span class="hljs-number">0</span>]</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="53"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rot_mat[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>] <span class="hljs-operator">+</span><span class="hljs-operator">=</span> rot_<span class="hljs-keyword">move</span>[<span class="hljs-number">1</span>]                                   # rot_matæ˜¯æœ€ç»ˆçš„æ—‹è½¬çŸ©é˜µ</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="54"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # point<span class="hljs-number">1</span> <span class="hljs-operator">=</span> np.dot(rot_mat, np.array([xmin, ymin, <span class="hljs-number">1</span>]))          #è¿™ç§æ–°ç”»å‡ºçš„æ¡†å¤§ä¸€åœˆ</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="55"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # point<span class="hljs-number">2</span> <span class="hljs-operator">=</span> np.dot(rot_mat, np.array([xmax, ymin, <span class="hljs-number">1</span>]))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="56"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # point<span class="hljs-number">3</span> <span class="hljs-operator">=</span> np.dot(rot_mat, np.array([xmax, ymax, <span class="hljs-number">1</span>]))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="57"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # point<span class="hljs-number">4</span> <span class="hljs-operator">=</span> np.dot(rot_mat, np.array([xmin, ymax, <span class="hljs-number">1</span>]))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="58"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    point<span class="hljs-number">1</span> <span class="hljs-operator">=</span> np.dot(rot_mat, np.array([(xmin<span class="hljs-operator">+</span>xmax)<span class="hljs-operator">/</span><span class="hljs-number">2</span>, ymin, <span class="hljs-number">1</span>]))   # è·å–åŸå§‹çŸ©å½¢çš„å››ä¸ªä¸­ç‚¹ï¼Œç„¶åå°†è¿™å››ä¸ªç‚¹è½¬æ¢åˆ°æ—‹è½¬åçš„åæ ‡ç³»ä¸‹</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="59"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    point<span class="hljs-number">2</span> <span class="hljs-operator">=</span> np.dot(rot_mat, np.array([xmax, (ymin<span class="hljs-operator">+</span>ymax)<span class="hljs-operator">/</span><span class="hljs-number">2</span>, <span class="hljs-number">1</span>]))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="60"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    point<span class="hljs-number">3</span> <span class="hljs-operator">=</span> np.dot(rot_mat, np.array([(xmin<span class="hljs-operator">+</span>xmax)<span class="hljs-operator">/</span><span class="hljs-number">2</span>, ymax, <span class="hljs-number">1</span>]))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="61"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    point<span class="hljs-number">4</span> <span class="hljs-operator">=</span> np.dot(rot_mat, np.array([xmin, (ymin<span class="hljs-operator">+</span>ymax)<span class="hljs-operator">/</span><span class="hljs-number">2</span>, <span class="hljs-number">1</span>]))</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="62"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    concat <span class="hljs-operator">=</span> np.vstack((point<span class="hljs-number">1</span>, point<span class="hljs-number">2</span>, point<span class="hljs-number">3</span>, point<span class="hljs-number">4</span>))            # åˆå¹¶np.array</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="63"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    # æ”¹å˜arrayç±»å‹</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="64"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    concat <span class="hljs-operator">=</span> concat.astype(np.int<span class="hljs-number">32</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="65"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    rx, ry, rw, <span class="hljs-keyword">rh</span> <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.boundingRect(concat)                        #rx,ry,ä¸ºæ–°çš„å¤–æ¥æ¡†å·¦ä¸Šè§’åæ ‡ï¼Œrwä¸ºæ¡†å®½åº¦ï¼Œ<span class="hljs-keyword">rh</span>ä¸ºé«˜åº¦ï¼Œæ–°çš„xmax<span class="hljs-operator">=</span>rx<span class="hljs-operator">+</span>rw,æ–°çš„ymax<span class="hljs-operator">=</span>ry<span class="hljs-operator">+</span><span class="hljs-keyword">rh</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="66"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword">return</span> rx, ry, rw, <span class="hljs-keyword">rh</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="67"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"> </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="68"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"># ä½¿å›¾åƒæ—‹è½¬<span class="hljs-number">60,90,120,150,210,240,300</span>åº¦</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="69"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="70"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">xmlpath <span class="hljs-operator">=</span> <span class="hljs-string">'./Annotations/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="71"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">imgpath <span class="hljs-operator">=</span> <span class="hljs-string">'./JPEGImages/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="72"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">rotated_imgpath <span class="hljs-operator">=</span> <span class="hljs-string">'./rotate/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="73"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">rotated_xmlpath <span class="hljs-operator">=</span> <span class="hljs-string">'./rotatexml/'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="74"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">#<span class="hljs-keyword">for</span> angle <span class="hljs-keyword">in</span> (<span class="hljs-number">90,270</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="75"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line"><span class="hljs-keyword">for</span> angle <span class="hljs-keyword">in</span> (<span class="hljs-number">5,10</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="76"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> os.listdir(imgpath):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="77"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        a, b <span class="hljs-operator">=</span> os.path.splitext(i)                            #åˆ†ç¦»å‡ºæ–‡ä»¶åa</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="78"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        #img <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.imread(imgpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'.jpg'</span>,<span class="hljs-number">0</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="79"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        img <span class="hljs-operator">=</span> cv<span class="hljs-number">2</span>.imread(imgpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'.jpg'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="80"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        rotated_img <span class="hljs-operator">=</span> rotate_image(img,angle)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="81"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        cv<span class="hljs-number">2</span>.imwrite(rotated_imgpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'_'</span><span class="hljs-operator">+</span> str(angle) <span class="hljs-operator">+</span><span class="hljs-string">'.jpg'</span>,rotated_img)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="82"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        #print str(i) <span class="hljs-operator">+</span> <span class="hljs-string">' has been rotated for '</span><span class="hljs-operator">+</span> str(angle)<span class="hljs-operator">+</span><span class="hljs-string">'Â°'</span></div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="83"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        tree <span class="hljs-operator">=</span> ET.parse(xmlpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'.xml'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="84"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        root <span class="hljs-operator">=</span> tree.getroot()</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="85"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="86"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">for</span> <span class="hljs-keyword">file</span><span class="hljs-number">1</span> <span class="hljs-keyword">in</span> root.findall(<span class="hljs-string">'filename'</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="87"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            #filename<span class="hljs-operator">=</span>str(<span class="hljs-keyword">file</span><span class="hljs-number">1</span>.find(<span class="hljs-string">'filename'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="88"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            <span class="hljs-keyword">file</span><span class="hljs-number">1</span>.text <span class="hljs-operator">=</span> str(a <span class="hljs-operator">+</span> <span class="hljs-string">'_'</span><span class="hljs-operator">+</span> str(angle)<span class="hljs-operator">+</span><span class="hljs-string">'.jpg'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="89"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            </div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="90"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        <span class="hljs-keyword">for</span> box <span class="hljs-keyword">in</span> root.iter(<span class="hljs-string">'bndbox'</span>):</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="91"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            xmin <span class="hljs-operator">=</span> float(box.find(<span class="hljs-string">'xmin'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="92"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            ymin <span class="hljs-operator">=</span> float(box.find(<span class="hljs-string">'ymin'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="93"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            xmax <span class="hljs-operator">=</span> float(box.find(<span class="hljs-string">'xmax'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="94"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            ymax <span class="hljs-operator">=</span> float(box.find(<span class="hljs-string">'ymax'</span>).text)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="95"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            x, y, w, h <span class="hljs-operator">=</span> rotate_xml(img, xmin, ymin, xmax, ymax, angle)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="96"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            cv<span class="hljs-number">2</span>.rectangle(rotated_img, (x, y), (x<span class="hljs-operator">+</span>w, y<span class="hljs-operator">+</span>h), [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>], <span class="hljs-number">2</span>)   #å¯åœ¨è¯¥æ­¥éª¤æµ‹è¯•æ–°ç”»çš„æ¡†ä½ç½®æ˜¯å¦æ­£ç¡®</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="97"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            # cv<span class="hljs-number">2</span>.imshow(<span class="hljs-string">'xmlbnd'</span>,rotated_img)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="98"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            # cv<span class="hljs-number">2</span>.waitKey(<span class="hljs-number">200</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="99"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'xmin'</span>).text <span class="hljs-operator">=</span> str(x)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="100"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'ymin'</span>).text <span class="hljs-operator">=</span> str(y)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="101"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'xmax'</span>).text <span class="hljs-operator">=</span> str(x<span class="hljs-operator">+</span>w)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="102"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">            box.find(<span class="hljs-string">'ymax'</span>).text <span class="hljs-operator">=</span> str(y<span class="hljs-operator">+</span>h)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="103"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        #cv<span class="hljs-number">2</span>.imwrite(<span class="hljs-string">"E:/test/VOC07/3/"</span> <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">"_"</span> <span class="hljs-operator">+</span> str(angle) <span class="hljs-operator">+</span><span class="hljs-string">".jpg"</span>,rotated_img)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="104"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        tree.<span class="hljs-keyword">write</span>(rotated_xmlpath <span class="hljs-operator">+</span> a <span class="hljs-operator">+</span> <span class="hljs-string">'_'</span><span class="hljs-operator">+</span> str(angle) <span class="hljs-operator">+</span><span class="hljs-string">'.xml'</span>)</div></div></li><li><div class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="105"></div></div><div class="hljs-ln-code"><div class="hljs-ln-line">        print (str(a) <span class="hljs-operator">+</span> <span class="hljs-string">'.xml has been rotated for '</span><span class="hljs-operator">+</span> str(angle)<span class="hljs-operator">+</span><span class="hljs-string">'Â°'</span>)</div></div></li></ol></code><div class="hide-preCode-box"><span class="hide-preCode-bt" data-report-view="{&quot;spm&quot;:&quot;1001.2101.3001.7365&quot;}"><img class="look-more-preCode contentImg-no-view" src="https://csdnimg.cn/release/blogv2/dist/pc/img/newCodeMoreWhite.png" alt="" title=""></span></div><div class="hljs-button {2}" data-title="å¤åˆ¶" onclick="hljs.copyCode(event)"></div></pre> 
<p></p>
                </div><div data-report-view="{&quot;mod&quot;:&quot;1585297308_001&quot;,&quot;spm&quot;:&quot;1001.2101.3001.6548&quot;,&quot;dest&quot;:&quot;https://cv2023.blog.csdn.net/article/details/130896875&quot;,&quot;extend1&quot;:&quot;pc&quot;,&quot;ab&quot;:&quot;new&quot;}"><div></div></div>
        </div>